# API 接口文档

## 用户认证相关接口

### 1. 发送邮箱验证码

**接口说明：** 用于注册、找回密码等场景发送邮箱验证码

- **请求URL：** `/api/auth/send-email-code`
- **请求方式：** POST
- **请求参数：**

| 参数名 | 类型   | 必选 | 说明     |
|--------|--------|------|----------|
| email  | string | 是   | 邮箱地址 |

- **响应参数：**

| 参数名  | 类型   | 说明     |
|---------|--------|----------|
| code    | number | 状态码   |
| message | string | 提示信息 |

- **响应示例：**

```json
{
    "code": 200,
    "message": "验证码发送成功"
}
```

- **错误码说明：**

| 错误码 | 说明                           |
|--------|--------------------------------|
| 200    | 成功                           |
| 400    | 参数错误（邮箱格式不正确等）   |
| 429    | 请求过于频繁，请稍后再试       |
| 500    | 服务器错误                     |

- **其他说明：**
  - 验证码有效期为10分钟
  - 同一邮箱地址60秒内只能发送一次验证码
  - 验证码为6位数字
  - **✅ 当前状态：已实现**

### 2. 用户注册

**接口说明：** 新用户注册接口

- **请求URL：** `/api/auth/register`
- **请求方式：** POST
- **请求参数：**

| 参数名     | 类型   | 必选 | 说明          |
|------------|--------|------|---------------|
| email      | string | 是   | 邮箱地址      |
| email_code | string | 是   | 邮箱验证码    |
| password   | string | 是   | 密码          |

- **响应参数：**

| 参数名  | 类型   | 说明     |
|---------|--------|----------|
| code    | number | 状态码   |
| message | string | 提示信息 |

- **响应示例：**

```json
{
    "code": 200,
    "message": "注册成功"
}
```

- **错误码说明：**

| 错误码 | 说明                           |
|--------|--------------------------------|
| 200    | 成功                           |
| 400    | 参数错误或验证码错误           |
| 409    | 邮箱已被注册                   |
| 500    | 服务器错误                     |

- **其他说明：**
  - 密码长度至少6位
  - 邮箱格式必须符合标准邮箱格式
  - 验证码必须是6位数字
  - 验证码有效期为10分钟
  - **✅ 当前状态：已实现**

### 3. 用户登录

**接口说明：** 用户登录接口

- **请求URL：** `/api/auth/login`
- **请求方式：** POST
- **请求参数：**

| 参数名   | 类型    | 必选 | 说明                |
|----------|---------|------|---------------------|
| email    | string  | 是   | 用户邮箱            |
| password | string  | 是   | 用户密码            |
| remember | boolean | 否   | 是否保持登录状态    |

- **响应参数：**

| 参数名  | 类型   | 说明                                |
|---------|--------|-------------------------------------|
| code    | number | 状态码                              |
| message | string | 提示信息                            |
| data    | object | 返回的数据，包含token和用户基本信息 |

- **data对象结构：**

| 参数名 | 类型   | 说明                 |
|--------|--------|----------------------|
| token  | string | 用户身份令牌         |
| user   | object | 用户基本信息         |

- **user对象结构：**

| 参数名      | 类型    | 说明               |
|-------------|---------|-------------------|
| id          | number  | 用户ID            |
| email       | string  | 用户邮箱          |
| nickname    | string  | 用户昵称          |
| avatar      | string  | 用户头像URL       |

- **响应示例：**

```json
{
    "code": 200,
    "message": "登录成功",
    "data": {
        "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
        "user": {
            "id": 1,
            "email": "user@example.com",
            "nickname": "示例用户",
            "avatar": "https://example.com/avatars/default.png"
        }
    }
}
```

- **错误码说明：**

| 错误码 | 说明                           |
|--------|--------------------------------|
| 200    | 成功                           |
| 400    | 参数错误                       |
| 401    | 账号或密码错误                 |
| 403    | 账号已被禁用                   |
| 500    | 服务器错误                     |

- **其他说明：**
  - token使用JWT格式，需要在后续请求的header中添加：`Authorization: Bearer {token}`
  - remember为true时，token有效期为30天；为false时，token有效期为24小时
  - 前端在登录成功后会将user信息存储在本地，格式为：`uni.setStorageSync('userInfo', res.data.user)`
  - 个人页面初始加载时会优先使用本地存储的用户信息进行显示，然后再通过API获取完整信息
  - 若接口调用失败，前端会使用本地存储的信息作为降级处理
  - 注意：后端返回的字段为`fansCount`，前端使用`followerCount`，需要在代码中进行适配
  - **✅ 当前状态：已实现**

### 4. 重置密码

**接口说明：** 通过邮箱验证码找回密码

- **请求URL：** `/api/auth/reset-password`
- **请求方式：** POST
- **请求参数：**

| 参数名       | 类型   | 必选 | 说明               |
|--------------|--------|------|-------------------|
| email        | string | 是   | 用户邮箱          |
| email_code   | string | 是   | 邮箱验证码        |
| new_password | string | 是   | 新密码            |

- **响应参数：**

| 参数名  | 类型   | 说明     |
|---------|--------|----------|
| code    | number | 状态码   |
| message | string | 提示信息 |

- **响应示例：**

```json
{
    "code": 200,
    "message": "密码重置成功"
}
```

- **错误码说明：**

| 错误码 | 说明                           |
|--------|--------------------------------|
| 200    | 成功                           |
| 400    | 参数错误或验证码错误           |
| 404    | 用户不存在                     |
| 409    | 新密码与原密码相同             |
| 500    | 服务器错误                     |

- **其他说明：**
  - 新密码长度至少6位
  - 系统会验证新密码与原密码是否相同，不允许设置为相同的密码
  - 验证码通过"发送邮箱验证码"接口获取
  - 验证码有效期为10分钟
  - **✅ 当前状态：已实现**

## 用户资料管理相关接口

### 1. 获取用户个人信息

**接口说明：** 获取当前登录用户的个人资料信息

- **请求URL：** `/api/user/info`
- **请求方式：** GET
- **请求参数：** 无

- **响应参数：**

| 参数名  | 类型   | 说明     |
|---------|--------|----------|
| code    | number | 状态码   |
| message | string | 提示信息 |
| data    | object | 用户信息 |

- **data对象结构：**

| 参数名         | 类型   | 说明                  |
|----------------|--------|---------------------|
| id             | number | 用户ID              |
| email          | string | 用户邮箱            |
| nickname       | string | 用户昵称            |
| avatar         | string | 用户头像URL         |
| bio            | string | 个人简介            |
| followCount    | number | 关注数量            |
| fansCount      | number | 粉丝数量            |
| articleCount   | number | 文章数量            |
| createTime     | string | 注册时间            |

- **响应示例：**

```json
{
    "code": 200,
    "message": "操作成功",
    "data": {
        "id": 1,
        "email": "user@example.com",
        "nickname": "示例用户",
        "avatar": "https://example.com/avatars/default.jpg",
        "bio": "这是我的个人简介",
        "followCount": 10,
        "fansCount": 5,
        "articleCount": 8,
        "createTime": "2023-05-01 12:00:00"
    }
}
```

- **错误码说明：**

| 错误码 | 说明                           |
|--------|--------------------------------|
| 200    | 成功                           |
| 401    | 未登录或token无效              |
| 500    | 服务器错误                     |

- **其他说明：**
  - 该接口需要在请求头中携带token才能访问
  - 用于个人主页信息展示
  - 前端"我的"页面会先使用本地存储的基本用户信息（来自登录响应），然后调用此接口获取完整用户信息
  - 若接口调用失败，前端会使用本地存储的信息作为降级处理
  - 注意：后端返回的字段为`fansCount`，前端使用`followerCount`，需要在代码中进行适配
  - **✅ 当前状态：已实现**

### 2. 更新用户个人资料

**接口说明：** 更新当前登录用户的个人资料

- **请求URL：** `/api/user/profile`
- **请求方式：** PUT
- **请求参数：**

| 参数名   | 类型   | 必选 | 说明       |
|----------|--------|------|------------|
| nickname | string | 否   | 用户昵称   |
| bio      | string | 否   | 个人简介   |

- **响应参数：**

| 参数名  | 类型   | 说明                 |
|---------|--------|----------------------|
| code    | number | 状态码               |
| message | string | 提示信息             |
| data    | object | 更新后的用户信息     |

- **data对象结构：**

| 参数名    | 类型   | 说明             |
|-----------|--------|------------------|
| nickname  | string | 更新后的用户昵称 |
| bio       | string | 更新后的个人简介 |

- **响应示例：**

```json
{
    "code": 200,
    "message": "个人资料更新成功",
    "data": {
        "nickname": "新昵称",
        "bio": "这是更新后的个人简介"
    }
}
```

- **错误码说明：**

| 错误码 | 说明                           |
|--------|--------------------------------|
| 200    | 成功                           |
| 400    | 参数错误                       |
| 401    | 未登录或token无效              |
| 500    | 服务器错误                     |

- **其他说明：**
  - 该接口需要在请求头中携带token才能访问
  - 可以只更新昵称或者只更新个人简介，不需要同时提供
  - 昵称长度限制：2-20个字符
  - 个人简介长度限制：0-200个字符
  - **✅ 当前状态：已实现**

### 3. 上传用户头像

**接口说明：** 上传或更新当前登录用户的头像

- **请求URL：** `/api/user/avatar`
- **请求方式：** POST
- **请求类型：** multipart/form-data
- **请求参数：**

| 参数名 | 类型 | 必选 | 说明     |
|--------|------|------|----------|
| avatar | file | 是   | 头像文件 |

- **响应参数：**

| 参数名  | 类型   | 说明             |
|---------|--------|------------------|
| code    | number | 状态码           |
| message | string | 提示信息         |
| data    | object | 上传成功后的信息 |

- **data对象结构：**

| 参数名    | 类型   | 说明                 |
|-----------|--------|----------------------|
| avatarUrl | string | 头像的访问URL        |

- **响应示例：**

```json
{
    "code": 200,
    "message": "头像上传成功",
    "data": {
        "avatarUrl": "https://example.com/avatars/user_1.jpg"
    }
}
```

- **错误码说明：**

| 错误码 | 说明                           |
|--------|--------------------------------|
| 200    | 成功                           |
| 400    | 文件格式不支持或文件过大       |
| 401    | 未登录或token无效              |
| 500    | 服务器错误                     |

- **其他说明：**
  - 该接口需要在请求头中携带token才能访问
  - 支持的文件格式：jpg、jpeg、png、gif
  - 文件大小限制：2MB
  - 上传成功后会自动裁剪和压缩图片
  - 旧头像会被自动删除
  - **✅ 当前状态：已实现**

### 4. 获取用户关注列表

**接口说明：** 获取当前登录用户的关注列表

- **请求URL：** `/api/user/follows`
- **请求方式：** GET
- **请求参数：**

| 参数名   | 类型   | 必选 | 说明                              |
|----------|--------|------|-----------------------------------|
| page     | number | 否   | 页码，默认1                       |
| pageSize | number | 否   | 每页条数，默认10，最大50          |
| keyword  | string | 否   | 搜索关键词，用于按昵称搜索关注的用户 |

- **响应参数：**

| 参数名  | 类型   | 说明         |
|---------|--------|--------------|
| code    | number | 状态码       |
| message | string | 提示信息     |
| data    | object | 分页数据     |

- **data对象结构：**

| 参数名      | 类型    | 说明               |
|-------------|---------|-------------------|
| total       | number  | 总记录数          |
| pages       | number  | 总页数            |
| list        | array   | 关注用户列表      |

- **list数组元素结构：**

| 参数名        | 类型    | 说明              |
|---------------|---------|------------------|
| id            | number  | 用户ID           |
| nickname      | string  | 用户昵称         |
| avatar        | string  | 用户头像URL      |
| bio           | string  | 用户个人简介     |
| isFollowedByMe | boolean | 当前登录用户是否关注此用户 |

- **响应示例：**

```json
{
    "code": 200,
    "message": "success",
    "data": {
        "total": 15,
        "pages": 2,
        "list": [
            {
                "id": 2,
                "nickname": "用户昵称",
                "avatar": "user_2_avatar.jpg",
                "bio": "这是个人简介",
                "isFollowedByMe": true
            },
            // 更多用户...
        ]
    }
}
```

- **错误码说明：**

| 错误码 | 说明                           |
|--------|--------------------------------|
| 200    | 成功                           |
| 401    | 未登录或token无效              |
| 500    | 服务器错误                     |

- **其他说明：**
  - 该接口需要在请求头中携带token才能访问
  - 返回的avatar字段可能存在三种形式：
    1. 仅文件名，如：`user_2_avatar.jpg`
    2. 完整相对路径，如：`/uploads/avatars/user_2_avatar.jpg`
    3. 完整URL，如：`http://example.com/uploads/avatars/user_2_avatar.jpg`
  - 前端需要根据不同情况处理头像URL，确保正确显示
  - 支持通过keyword参数搜索用户昵称
  - 可配合关注/取消关注接口实现关注管理
  - **✅ 当前状态：已实现**

### 5. 关注用户

**接口说明：** 关注指定用户

- **请求URL：** `/api/user/follow/{userId}`
- **请求方式：** POST
- **请求参数：**

| 参数名 | 类型   | 必选 | 说明                    |
|--------|--------|------|------------------------|
| userId | number | 是   | 要关注的用户ID，包含在URL路径中 |

- **响应参数：**

| 参数名  | 类型   | 说明         |
|---------|--------|--------------|
| code    | number | 状态码       |
| message | string | 提示信息     |

- **响应示例：**

```json
{
    "code": 200,
    "message": "关注成功"
}
```

- **错误码说明：**

| 错误码 | 说明                           |
|--------|--------------------------------|
| 200    | 成功                           |
| 400    | 不能关注自己                   |
| 401    | 未登录或token无效              |
| 404    | 用户不存在                     |
| 409    | 已经关注过该用户               |
| 500    | 服务器错误                     |

- **✅ 当前状态：已实现**

### 6. 取消关注用户

**接口说明：** 取消关注指定用户

- **请求URL：** `/api/user/follow/{userId}`
- **请求方式：** DELETE 
- **请求参数：**

| 参数名 | 类型   | 必选 | 说明                    |
|--------|--------|------|------------------------|
| userId | number | 是   | 要取消关注的用户ID，包含在URL路径中 |

- **响应参数：**

| 参数名  | 类型   | 说明         |
|---------|--------|--------------|
| code    | number | 状态码       |
| message | string | 提示信息     |

- **响应示例：**

```json
{
    "code": 200,
    "message": "已取消关注"
}
```

- **错误码说明：**

| 错误码 | 说明                           |
|--------|--------------------------------|
| 200    | 成功                           |
| 401    | 未登录或token无效              |
| 404    | 用户不存在或未关注该用户       |
| 500    | 服务器错误                     |

- **✅ 当前状态：已实现**

### 7. 获取用户粉丝列表

**接口说明：** 获取指定用户的粉丝列表

- **请求URL：** `/api/user/followers/{userId}`
- **请求方式：** GET
- **请求参数：**

| 参数名   | 类型   | 必选 | 说明                              |
|----------|--------|------|-----------------------------------|
| userId   | number | 是   | 用户ID，包含在URL路径中           |
| page     | number | 否   | 页码，默认1                       |
| pageSize | number | 否   | 每页条数，默认10，最大50          |

- **响应参数：**

| 参数名  | 类型   | 说明         |
|---------|--------|--------------|
| code    | number | 状态码       |
| message | string | 提示信息     |
| data    | object | 分页数据     |

- **data对象结构：**

| 参数名      | 类型    | 说明               |
|-------------|---------|-------------------|
| total       | number  | 总记录数          |
| pages       | number  | 总页数            |
| currentPage | number  | 当前页码          |
| pageSize    | number  | 每页条数          |
| list        | array   | 粉丝用户列表      |

- **list数组元素结构：**

| 参数名        | 类型    | 说明              |
|---------------|---------|------------------|
| id            | number  | 用户ID           |
| nickname      | string  | 用户昵称         |
| avatar        | string  | 用户头像URL      |
| bio           | string  | 用户个人简介     |
| isFollowing   | boolean | 当前登录用户是否关注此用户 |

- **✅ 当前状态：已实现**

### 8. 获取用户资料

**接口说明：** 获取指定用户的详细资料

- **请求URL：** `/api/user/profile/{userId}`
- **请求方式：** GET
- **请求参数：**

| 参数名 | 类型   | 必选 | 说明                    |
|--------|--------|------|------------------------|
| userId | number | 是   | 用户ID，包含在URL路径中 |

- **响应参数：**

| 参数名  | 类型   | 说明         |
|---------|--------|--------------|
| code    | number | 状态码       |
| message | string | 提示信息     |
| data    | object | 用户资料     |

- **data对象结构：**

| 参数名         | 类型    | 说明                          |
|---------------|---------|------------------------------|
| id            | number  | 用户ID                       |
| nickname      | string  | 用户昵称                     |
| avatar        | string  | 用户头像URL                  |
| bio           | string  | 个人简介                     |
| postCount     | number  | 发表的文章数量               |
| followCount   | number  | 关注数量                     |
| followerCount | number  | 粉丝数量                     |

- **响应示例：**

```json
{
    "code": 200,
    "message": "success",
    "data": {
        "id": 1,
        "nickname": "示例用户",
        "avatar": "/uploads/avatars/user_1_1746006650938.jpg",
        "bio": "这是我的个人简介",
        "postCount": 10,
        "followCount": 20,
        "followerCount": 30
    }
}
```

- **错误码说明：**

| 错误码 | 说明           |
|--------|--------------|
| 200    | 请求成功     |
| 404    | 用户不存在   |
| 500    | 服务器错误   |

- **其他说明：**
  - avatar可能返回完整路径（以/uploads开头）或仅文件名
  - 前端需要处理avatar字段，确保显示完整URL
  - **✅ 当前状态：已实现**

### 9. 获取用户文章列表

**接口说明：** 获取指定用户发表或点赞的文章列表

- **请求URL：** `/api/user/{userId}/articles`
- **请求方式：** GET
- **请求参数：**

| 参数名   | 类型   | 必选 | 说明                                    |
|----------|--------|------|----------------------------------------|
| userId   | number | 是   | 用户ID，包含在URL路径中                 |
| type     | string | 是   | 文章类型：posts(发表的) / likes(点赞的) |
| page     | number | 否   | 页码，默认1                             |
| pageSize | number | 否   | 每页条数，默认10                        |

- **响应参数：**

| 参数名  | 类型   | 说明         |
|---------|--------|--------------|
| code    | number | 状态码       |
| message | string | 提示信息     |
| data    | object | 分页数据     |

- **data对象结构：**

| 参数名      | 类型    | 说明               |
|-------------|---------|-------------------|
| total       | number  | 总记录数          |
| list        | array   | 文章列表          |

- **list数组元素结构：**

| 参数名        | 类型    | 说明              |
|---------------|---------|------------------|
| id            | number  | 文章ID           |
| title         | string  | 文章标题         |
| summary       | string  | 文章摘要         |
| createTime    | string  | 发布时间         |
| viewCount     | number  | 浏览量           |
| likeCount     | number  | 点赞量           |
| commentCount  | number  | 评论量           |

- **响应示例：**

```json
{
    "code": 200,
    "message": "success",
    "data": {
        "total": 20,
        "list": [
            {
                "id": 1,
                "title": "文章标题",
                "summary": "文章摘要...",
                "createTime": "2024-03-20 10:00:00",
                "viewCount": 100,
                "likeCount": 50,
                "commentCount": 30
            }
        ]
    }
}
```

- **⚠️ 当前状态：已实现**

### 10. 检查是否关注用户

**接口说明：** 检查当前登录用户是否关注了指定用户

- **请求URL：** `/api/user/check-follow/{userId}`
- **请求方式：** GET
- **请求参数：**

| 参数名 | 类型   | 必选 | 说明                    |
|--------|--------|------|------------------------|
| userId | number | 是   | 要检查的用户ID，包含在URL路径中 |

- **响应参数：**

| 参数名  | 类型   | 说明         |
|---------|--------|--------------|
| code    | number | 状态码       |
| message | string | 提示信息     |
| data    | object | 关注状态信息 |

- **data对象结构：**

| 参数名    | 类型    | 说明         |
|-----------|---------|--------------|
| following | boolean | 是否已关注该用户 |

- **响应示例：**

```json
{
    "code": 200,
    "message": "success",
    "data": {
        "following": true
    }
}
```

- **错误码说明：**

| 错误码 | 说明           |
|--------|--------------|
| 200    | 请求成功     |
| 401    | 未登录或token无效 |
| 404    | 用户不存在   |
| 500    | 服务器错误   |

- **其他说明：**
  - 该接口需要在请求头中携带token才能访问
  - 用于用户资料页面加载时检查关注状态
  - 如果用户未登录，返回401错误
  - 如果检查的是当前登录用户自己，将返回`following: false`（不能关注自己）
  - **✅ 当前状态：已实现**

## 功能说明

### 用户资料展示页面

1. 页面功能：
   - 显示用户基本信息（头像、昵称、个人简介）
   - 显示用户统计信息（发表数、关注数、粉丝数）
   - 支持关注/取消关注功能
   - 支持点击头像查看大图
   - 自适应布局，适合各种屏幕尺寸
   - 个人简介区域显示"个人简介："标签，文本自动换行

2. 数据处理：
   - 页面加载时通过 `/api/user/profile/{userId}` 获取用户资料
   - 使用 `/api/user/check-follow/{userId}` 检查关注状态
   - 头像URL处理支持多种格式：
     - 空值返回默认头像
     - http(s)链接直接使用
     - /uploads开头的完整相对路径
     - 仅文件名的情况
   - 统计数据（发表数、关注数、粉丝数）自动显示
   - 后端返回的 `followerCount` 用于显示粉丝数

3. 样式说明：
   - 个人简介区域宽度自适应（最大宽度100%）
   - 添加了合适的行高（line-height: 1.4）
   - 支持长文本自动换行（word-wrap: break-word）
   - 兼容APP、微信小程序和H5三个平台

4. 实现细节：
   - 使用 box-sizing: border-box 确保跨平台一致性
   - 使用 flex 布局实现自适应效果
   - 头像使用 flex-shrink: 0 防止缩小
   - 使用条件编译确保在不同平台显示一致
   - **✅ 当前状态：已实现**

### 关注列表页面

1. 页面功能：
   - 显示当前用户的关注列表
   - 支持搜索关注的用户（按昵称）
   - 支持下拉刷新和上拉加载更多
   - 可关注/取消关注列表中的用户
   - 点击用户可跳转到其个人资料页

2. 数据处理：
   - 通过 `/api/user/follows` 接口获取关注列表
   - 支持分页加载（pageSize默认10）
   - 关注/取消关注功能通过 `/api/user/follow/{userId}` 接口实现
   - 取消关注时会显示确认对话框
   - 头像URL处理支持三种格式：
     - 空值返回默认头像 `/static/images/avatar.png`
     - http(s)链接直接使用
     - /uploads开头的完整相对路径，拼接baseURL
     - 仅文件名的情况，拼接完整路径`${baseURL}/uploads/avatars/${avatar}`

3. 样式说明：
   - 列表项高度固定为160rpx，确保一致的视觉效果
   - 个人简介文本超出显示省略号（单行显示）
   - 个人简介最大宽度为420rpx
   - 按钮使用flex-shrink: 0确保不被挤压

4. 交互优化：
   - 关注/取消关注按钮添加loading状态
   - 操作成功和失败都有明确的Toast提示
   - 搜索、刷新、加载更多功能无缝配合
   - 无关注用户时显示空状态提示并提供"去发现更多"按钮
   - 下拉刷新时确保刷新区域背景色与页面背景一致
   - 在H5环境下支持新窗口打开用户资料页
   - 从关注列表返回"我的"页面时，自动刷新关注数据

5. 搜索功能实现：
   - 支持按用户昵称进行实时搜索和回车键确认搜索
   - 搜索使用后端API的keyword参数：`/api/user/follows?keyword=xxx`
   - 搜索输入添加防抖处理（300ms），避免频繁请求
   - 搜索过程中显示Loading状态提示"搜索中..."
   - 搜索结果会清空当前列表并重置分页，显示匹配的关注用户
   - 搜索成功后会显示结果数量提示（例如"找到3位相关用户"）
   - 无搜索结果时显示专门的空状态提示和清除搜索按钮
   - 搜索输入框提供一键清除功能，清除后自动恢复完整关注列表
   - 搜索结果支持继续上拉加载更多（保持与普通列表一致的加载逻辑）
   - 适当处理搜索过程中可能出现的错误情况，包括后端409错误（已关注过该用户）
   - **✅ 当前状态：已实现**

### 关注状态刷新机制

1. 功能说明：
   - 在"我的"页面添加关注数量自动刷新机制
   - 关注/取消关注操作后，返回"我的"页面自动更新关注数量
   - 在用户资料页面添加关注/取消关注功能
   - 支持页面间数据同步，确保关注状态一致性

2. 实现方式：
   - 在my.vue的onShow生命周期中添加refreshUserInfo方法
   - 使用节流控制避免短时间内多次刷新
   - 静默刷新用户信息，无需显示loading状态
   - 在user-profile.vue中添加关注按钮和关注状态检查
   - 使用checkUserFollow API检查关注状态
   - 提供关注状态检查的降级方案，兼容后端API尚未实现的情况

3. 交互优化：
   - 关注/取消关注操作添加确认对话框
   - 关注/取消关注过程中显示loading状态
   - 操作成功后显示明确的反馈提示
   - 取消关注时显示确认对话框，避免误操作
   - 在关注列表中取消关注后，自动从列表中移除用户
   - **✅ 当前状态：已实现**

### 文章发布页面

1. 页面功能：
   - 支持富文本编辑，包括文本格式化（加粗、斜体、下划线、标题等）
   - 支持添加标题和正文内容，自动统计字数
   - 提供编辑和预览两种模式切换
   - 支持添加文章标签（最多5个）
   - 支持上传文章封面图片
   - 支持在正文中插入多张图片（最多20张）
   - 支持发布新文章和编辑已有文章
   - 离开页面时的内容保存提示
   - 支持无图片文章的直接提交功能
   - 提供自动保存草稿功能，防止内容丢失

2. 数据处理：
   - 自动处理图片上传，支持本地图片到服务器URL的转换
   - 图片处理支持大小限制（最大5MB）和格式检查
   - 封面图片比例检查，建议使用16:9比例
   - 自动从HTML内容中提取图片路径，构建完整的发布请求
   - 支持标题长度限制（最多50个字符）和内容长度检查
   - 支持粘贴图片直接插入到编辑器
   - 发布成功后自动跳转到文章详情页
   - 统一API基础URL配置，确保所有请求使用同一端口
   - 自动处理DOM相关错误，提高跨平台兼容性

3. 编辑器特性：
   - 支持自适应高度，根据内容自动调整
   - 固定底部工具栏，确保工具随时可用
   - 预览模式下提供完整的文章预览效果，支持长文章滚动显示
   - 图片宽度固定为100%，确保在所有设备上显示一致
   - 支持图片删除和重新上传
   - 支持添加和管理自定义标签
   - 支持富文本内容格式的保存和恢复
   - 优化编辑器高度计算，更好地适应各种内容长度

4. 用户体验优化：
   - 表单验证提示，确保内容完整性
   - 图片上传状态提示和进度反馈
   - 编辑/预览模式无缝切换
   - 发布前确认对话框
   - 退出编辑的确认提示，防止误操作丢失内容
   - 工具栏简洁明了，提供基本的编辑功能
   - 预览模式下展示真实的文章效果
   - 自动保存草稿（每分钟）和退出时草稿保存提示
   - 应用启动时自动检测并提示加载草稿内容
   - 添加条件编译指令处理不同平台DOM操作兼容性

5. 草稿功能实现：
   - 自动检测未发布的草稿内容并提示恢复
   - 定时自动保存（每60秒保存一次）
   - 保存内容包括标题、正文、HTML格式、标签和封面图片
   - 支持24小时内草稿有效期限制，过期自动清理
   - 用户可选择恢复草稿或放弃旧草稿
   - 文章成功发布后自动清理草稿数据
   - **✅ 当前状态：已实现**

## 文章管理相关接口

### 1. 发布文章

**接口说明：** 发布新文章

- **请求URL：** `/api/article`
- **请求方式：** POST
- **请求参数：**

| 参数名      | 类型            | 必选 | 说明                 |
|-------------|-----------------|------|---------------------|
| title       | string          | 是   | 文章标题            |
| content     | string          | 是   | 文章纯文本内容      |
| htmlContent | string          | 是   | 文章HTML格式内容    |
| tags        | Array\<string\> | 否   | 文章标签数组        |
| coverImage  | string          | 否   | 文章封面图片URL     |

- **响应参数：**

| 参数名  | 类型   | 说明               |
|---------|--------|-------------------|
| code    | number | 状态码            |
| message | string | 提示信息          |
| data    | object | 返回的数据        |

- **data对象结构：**

| 参数名 | 类型   | 说明        |
|--------|--------|------------|
| id     | number | 新发布文章的ID |

- **响应示例：**

```json
{
    "code": 200,
    "message": "文章发布成功",
    "data": {
        "id": 1001
    }
}
```

- **错误码说明：**

| 错误码 | 说明                     |
|--------|-------------------------|
| 200    | 成功                    |
| 400    | 参数错误                |
| 401    | 未登录或token无效       |
| 500    | 服务器错误              |

- **其他说明：**
  - 该接口需要在请求头中携带token才能访问
  - 文章标题长度限制：2-100个字符
  - 文章内容不能为空
  - tags为可选参数，如提供则为字符串数组，每个标签最长20个字符
  - coverImage为封面图片URL，支持用户专门上传的封面图片
  - 前端会自动处理图片上传，包括从本地路径转换为服务器URL
  - **✅ 当前状态：已实现**

### 2. 更新文章

**接口说明：** 更新现有文章

- **请求URL：** `/api/article/{articleId}`
- **请求方式：** PUT
- **请求参数：**

| 参数名      | 类型            | 必选 | 说明                 |
|-------------|-----------------|------|---------------------|
| articleId   | number          | 是   | 文章ID (URL路径参数) |
| title       | string          | 是   | 文章标题            |
| content     | string          | 是   | 文章纯文本内容      |
| htmlContent | string          | 是   | 文章HTML格式内容    |
| tags        | Array\<string\> | 否   | 文章标签数组        |
| coverImage  | string          | 否   | 文章封面图片URL     |

- **响应参数：**

| 参数名  | 类型   | 说明         |
|---------|--------|--------------|
| code    | number | 状态码       |
| message | string | 提示信息     |

- **响应示例：**

```json
{
    "code": 200,
    "message": "文章更新成功"
}
```

- **错误码说明：**

| 错误码 | 说明                     |
|--------|-------------------------|
| 200    | 成功                    |
| 400    | 参数错误                |
| 401    | 未登录或token无效       |
| 403    | 无权限修改此文章        |
| 404    | 文章不存在              |
| 500    | 服务器错误              |

- **其他说明：**
  - 该接口需要在请求头中携带token才能访问
  - 用户只能更新自己发布的文章
  - 其他参数要求同发布文章接口
  - **✅ 当前状态：已实现**

### 3. 上传文章图片

**接口说明：** 上传文章中使用的图片，包括正文图片和封面图片

- **请求URL：** `/api/article/upload-image`
- **请求方式：** POST
- **请求类型：** multipart/form-data
- **请求参数：**

| 参数名 | 类型 | 必选 | 说明     |
|--------|------|------|----------|
| image  | file | 是   | 图片文件 |
| type   | string | 否 | 图片类型：cover(封面图)或content(正文图)，默认为content |
| width  | number | 否 | 原始图片宽度，用于服务器生成缩略图 |
| height | number | 否 | 原始图片高度，用于服务器生成缩略图 |

- **响应参数：**

| 参数名  | 类型   | 说明             |
|---------|--------|------------------|
| code    | number | 状态码           |
| message | string | 提示信息         |
| data    | object | 上传成功后的信息 |

- **data对象结构：**

| 参数名         | 类型   | 说明                 |
|----------------|--------|----------------------|
| imageUrl       | string | 图片的访问URL        |
| thumbnailUrl   | string | 缩略图的访问URL      |
| type           | string | 图片类型：cover或content |
| width          | number | 原始图片宽度         |
| height         | number | 原始图片高度         |

- **响应示例：**

```json
{
    "code": 200,
    "message": "图片上传成功",
    "data": {
        "imageUrl": "http://example.com/uploads/articles/image_1234567890.jpg",
        "thumbnailUrl": "http://example.com/uploads/articles/thumbnails/image_1234567890.jpg",
        "type": "content",
        "width": 1200,
        "height": 800
    }
}
```

- **错误码说明：**

| 错误码 | 说明                           |
|--------|--------------------------------|
| 200    | 成功                           |
| 400    | 文件格式不支持或文件过大       |
| 401    | 未登录或token无效              |
| 500    | 服务器错误                     |

- **其他说明：**
  - 该接口需要在请求头中携带token才能访问
  - 支持的文件格式：jpg、jpeg、png、gif
  - 文件大小限制：5MB
  - 上传成功后会自动处理和压缩图片
  - 封面图片会进行额外的处理，如裁剪为特定比例（16:9）和尺寸
  - 正文图片会自动生成缩略图，在编辑模式使用缩略图，预览和发布时使用原图
  - thumbnailUrl用于在编辑器中显示缩略图，imageUrl用于实际文章展示
  - 前端会自动处理缩略图与原图的切换逻辑，后端只需提供两个URL
  - 返回的imageUrl和thumbnailUrl均为完整的图片访问URL
  - 图片会被保存在服务器的articles目录下
  - type参数用于区分图片用途，可用于后端不同的处理逻辑
  - width和height参数可用于后端生成合适尺寸的缩略图
  - **✅ 当前状态：已实现**

### 4. 获取文章列表

**接口说明：** 获取文章列表，支持分页、标签筛选和关键词搜索

- **请求URL：** `/api/article`
- **请求方式：** GET
- **请求参数：**

| 参数名   | 类型   | 必选 | 说明                              |
|----------|--------|------|-----------------------------------|
| page     | number | 否   | 页码，默认1                       |
| pageSize | number | 否   | 每页条数，默认10，最大50          |
| tag      | string | 否   | 标签筛选                          |
| keyword  | string | 否   | 关键词搜索，匹配标题和内容        |

- **响应参数：**

| 参数名  | 类型   | 说明         |
|---------|--------|--------------|
| code    | number | 状态码       |
| message | string | 提示信息     |
| data    | object | 分页数据     |

- **data对象结构：**

| 参数名      | 类型    | 说明               |
|-------------|---------|-------------------|
| total       | number  | 总记录数          |
| pages       | number  | 总页数            |
| list        | array   | 文章列表          |

- **list数组元素结构：**

| 参数名         | 类型             | 说明                 |
|----------------|------------------|---------------------|
| id             | number           | 文章ID              |
| title          | string           | 文章标题            |
| summary        | string           | 文章摘要            |
| content        | string           | 文章内容（纯文本）  |
| coverImage     | string           | 封面图片URL         |
| tags           | Array\<string\>  | 文章标签            |
| viewCount      | number           | 浏览量              |
| likeCount      | number           | 点赞数              |
| commentCount   | number           | 评论数              |
| userId         | number           | 作者ID              |
| nickname       | string           | 作者昵称            |
| avatar         | string           | 作者头像            |
| createTime     | string           | 创建时间            |
| updateTime     | string           | 更新时间            |

- **⚠️ 当前状态：已实现**

### 5. 获取文章详情

**接口说明：** 获取单篇文章的详细内容

- **请求URL：** `/api/article/{articleId}`
- **请求方式：** GET
- **请求参数：**

| 参数名    | 类型   | 必选 | 说明                    |
|-----------|--------|------|------------------------|
| articleId | number | 是   | 文章ID，包含在URL路径中 |

- **响应参数：**

| 参数名  | 类型   | 说明         |
|---------|--------|--------------|
| code    | number | 状态码       |
| message | string | 提示信息     |
| data    | object | 文章详情     |

- **data对象结构：**

| 参数名         | 类型             | 说明                          |
|----------------|------------------|------------------------------|
| id             | number           | 文章ID                       |
| title          | string           | 文章标题                     |
| content        | string           | 文章内容（纯文本）           |
| htmlContent    | string           | 文章HTML内容                 |
| coverImage     | string           | 封面图片URL                  |
| images         | Array\<object\>  | 文章图片数组，包含原图和缩略图URL |
| tags           | Array\<string\>  | 文章标签                     |
| viewCount      | number           | 浏览量                       |
| likeCount      | number           | 点赞数                       |
| commentCount   | number           | 评论数                       |
| isLiked        | boolean          | 当前用户是否已点赞           |
| isCollected    | boolean          | 当前用户是否已收藏           |
| userId         | number           | 作者ID                       |
| nickname       | string           | 作者昵称                     |
| avatar         | string           | 作者头像                     |
| isFollowed     | boolean          | 当前用户是否已关注作者       |
| createTime     | string           | 创建时间                     |
| updateTime     | string           | 更新时间                     |

- **images数组元素结构：**

| 参数名       | 类型   | 说明               |
|--------------|--------|-------------------|
| imageUrl     | string | 原始图片URL       |
| thumbnailUrl | string | 缩略图URL         |
| width        | number | 图片原始宽度      |
| height       | number | 图片原始高度      |

- **响应示例：**

```json
{
    "code": 200,
    "message": "success",
    "data": {
        "id": 1001,
        "title": "示例文章标题",
        "content": "这是文章的纯文本内容...",
        "htmlContent": "<p>这是文章的HTML内容...</p><img class='article-content-image' src='https://example.com/uploads/articles/image_1.jpg' />",
        "coverImage": "https://example.com/uploads/articles/cover_1001.jpg",
        "images": [
            {
                "imageUrl": "https://example.com/uploads/articles/image_1.jpg",
                "thumbnailUrl": "https://example.com/uploads/articles/thumbnails/image_1.jpg",
                "width": 1200,
                "height": 800
            }
        ],
        "tags": ["技术", "教程"],
        "viewCount": 120,
        "likeCount": 30,
        "commentCount": 15,
        "isLiked": false,
        "isCollected": true,
        "userId": 1,
        "nickname": "示例用户",
        "avatar": "https://example.com/uploads/avatars/user_1.jpg",
        "isFollowed": false,
        "createTime": "2024-05-01 10:00:00",
        "updateTime": "2024-05-01 10:00:00"
    }
}
```

- **错误码说明：**

| 错误码 | 说明           |
|--------|--------------|
| 200    | 请求成功     |
| 404    | 文章不存在   |
| 500    | 服务器错误   |

- **其他说明：**
  - isLiked、isCollected、isFollowed等字段仅在用户已登录的情况下有意义
  - 未登录用户访问时，这些字段默认为false
  - 访问文章详情会自动增加文章的浏览量
  - htmlContent字段包含完整的富文本格式内容，适合直接在前端富文本组件中展示
  - **⚠️ 当前状态：已实现**

### 6. 点赞/取消点赞文章

**接口说明：** 对文章进行点赞或取消点赞操作

- **请求URL：** `/api/article/like/{articleId}`
- **请求方式：** POST (点赞) / DELETE (取消点赞)
- **请求参数：**

| 参数名    | 类型   | 必选 | 说明                     |
|-----------|--------|------|-------------------------|
| articleId | number | 是   | 文章ID，包含在URL路径中  |

- **响应参数：**

| 参数名  | 类型   | 说明         |
|---------|--------|--------------|
| code    | number | 状态码       |
| message | string | 提示信息     |
| data    | object | 返回数据     |

- **data对象结构：**

| 参数名    | 类型   | 说明           |
|-----------|--------|---------------|
| likeCount | number | 更新后的点赞数 |

- **响应示例：**

```json
{
    "code": 200,
    "message": "点赞成功",
    "data": {
        "likeCount": 31
    }
}
```

- **错误码说明：**

| 错误码 | 说明                     |
|--------|-------------------------|
| 200    | 成功                    |
| 401    | 未登录或token无效       |
| 404    | 文章不存在              |
| 409    | 已点赞或已取消点赞      |
| 500    | 服务器错误              |

- **其他说明：**
  - 该接口需要在请求头中携带token才能访问
  - POST请求表示点赞，DELETE请求表示取消点赞
  - 用户不能重复点赞同一篇文章
  - 点赞/取消点赞操作会实时更新文章的点赞数
  - **⚠️ 当前状态：已实现**

### 7. 收藏/取消收藏文章

**接口说明：** 对文章进行收藏或取消收藏操作

- **请求URL：** `/api/article/collect/{articleId}`
- **请求方式：** POST (收藏) / DELETE (取消收藏)
- **请求参数：**

| 参数名    | 类型   | 必选 | 说明                     |
|-----------|--------|------|-------------------------|
| articleId | number | 是   | 文章ID，包含在URL路径中  |

- **响应参数：**

| 参数名  | 类型   | 说明         |
|---------|--------|--------------|
| code    | number | 状态码       |
| message | string | 提示信息     |

- **响应示例：**

```json
{
    "code": 200,
    "message": "收藏成功"
}
```

- **错误码说明：**

| 错误码 | 说明                     |
|--------|-------------------------|
| 200    | 成功                    |
| 401    | 未登录或token无效       |
| 404    | 文章不存在              |
| 409    | 已收藏或已取消收藏      |
| 500    | 服务器错误              |

- **其他说明：**
  - 该接口需要在请求头中携带token才能访问
  - POST请求表示收藏，DELETE请求表示取消收藏
  - 用户不能重复收藏同一篇文章
  - **⚠️ 当前状态：已实现**

### 8. 获取用户收藏的文章列表

**接口说明：** 获取当前登录用户收藏的文章列表

- **请求URL：** `/api/article/collections`
- **请求方式：** GET
- **请求参数：**

| 参数名   | 类型   | 必选 | 说明                     |
|----------|--------|------|-------------------------|
| page     | number | 否   | 页码，默认1             |
| pageSize | number | 否   | 每页条数，默认10，最大50 |

- **响应参数：**

| 参数名  | 类型   | 说明         |
|---------|--------|--------------|
| code    | number | 状态码       |
| message | string | 提示信息     |
| data    | object | 分页数据     |

- **data对象结构：**

| 参数名 | 类型   | 说明         |
|--------|--------|--------------|
| total  | number | 总记录数     |
| pages  | number | 总页数       |
| list   | array  | 文章列表     |

- **list数组元素结构：** 同文章列表接口

- **错误码说明：**

| 错误码 | 说明                     |
|--------|-------------------------|
| 200    | 成功                    |
| 401    | 未登录或token无效       |
| 500    | 服务器错误              |

- **其他说明：**
  - 该接口需要在请求头中携带token才能访问
  - 返回的是当前登录用户的收藏文章
  - **⚠️ 当前状态：已实现**

### 9. 获取文章标签列表

**接口说明：** 获取系统中所有的文章标签

- **请求URL：** `/api/article/tags`
- **请求方式：** GET
- **请求参数：** 无

- **响应参数：**

| 参数名  | 类型   | 说明         |
|---------|--------|--------------|
| code    | number | 状态码       |
| message | string | 提示信息     |
| data    | array  | 标签列表     |

- **data数组元素结构：**

| 参数名 | 类型   | 说明       |
|--------|--------|------------|
| name   | string | 标签名称   |
| count  | number | 文章数量   |

- **响应示例：**

```json
{
    "code": 200,
    "message": "success",
    "data": [
        {
            "name": "技术",
            "count": 120
        },
        {
            "name": "生活",
            "count": 85
        },
        {
            "name": "旅行",
            "count": 42
        }
    ]
}
```

- **错误码说明：**

| 错误码 | 说明         |
|--------|------------|
| 200    | 成功       |
| 500    | 服务器错误 |

- **其他说明：**
  - 该接口可以在未登录状态下访问
  - 返回的标签按文章数量降序排列
  - 标签数据会被缓存，定期更新
  - **⚠️ 当前状态：已实现**

## 评论管理相关接口

### 1. 获取文章评论列表

**接口说明：** 获取指定文章的评论列表

- **请求URL：** `/api/article/{articleId}/comments`
- **请求方式：** GET
- **请求参数：**

| 参数名    | 类型   | 必选 | 说明                     |
|-----------|--------|------|-------------------------|
| articleId | number | 是   | 文章ID，包含在URL路径中  |
| page      | number | 否   | 页码，默认1             |
| pageSize  | number | 否   | 每页条数，默认10，最大50 |

- **响应参数：**

| 参数名  | 类型   | 说明         |
|---------|--------|--------------|
| code    | number | 状态码       |
| message | string | 提示信息     |
| data    | object | 分页数据     |

- **data对象结构：**

| 参数名 | 类型   | 说明         |
|--------|--------|--------------|
| total  | number | 总记录数     |
| pages  | number | 总页数       |
| list   | array  | 评论列表     |

- **list数组元素结构：**

| 参数名       | 类型    | 说明                 |
|--------------|---------|---------------------|
| id           | number  | 评论ID              |
| content      | string  | 评论内容            |
| createTime   | string  | 评论时间            |
| userId       | number  | 评论用户ID          |
| nickname     | string  | 评论用户昵称        |
| avatar       | string  | 评论用户头像        |
| likeCount    | number  | 点赞数              |
| isLiked      | boolean | 当前用户是否已点赞  |
| parentId     | number  | 父评论ID，一级评论为null |
| replyUserId  | number  | 回复用户ID，一级评论为null |
| replyNickname| string  | 回复用户昵称，一级评论为null |
| replies      | array   | 子评论列表，可能为空 |

- **⚠️ 当前状态：已实现**

### 2. 发表评论

**接口说明：** 对文章发表评论或回复其他评论

- **请求URL：** `/api/article/{articleId}/comment`
- **请求方式：** POST
- **请求参数：**

| 参数名      | 类型   | 必选 | 说明                         |
|-------------|--------|------|-----------------------------|
| articleId   | number | 是   | 文章ID，包含在URL路径中      |
| content     | string | 是   | 评论内容                     |
| parentId    | number | 否   | 父评论ID，回复评论时必需     |
| replyUserId | number | 否   | 被回复用户ID，回复评论时必需 |

- **响应参数：**

| 参数名  | 类型   | 说明              |
|---------|--------|------------------|
| code    | number | 状态码           |
| message | string | 提示信息         |
| data    | object | 新评论信息       |

- **data对象结构：**

| 参数名     | 类型   | 说明           |
|------------|--------|---------------|
| id         | number | 新评论ID      |
| createTime | string | 评论创建时间   |

- **错误码说明：**

| 错误码 | 说明                     |
|--------|-------------------------|
| 200    | 成功                    |
| 400    | 参数错误                |
| 401    | 未登录或token无效       |
| 404    | 文章不存在              |
| 500    | 服务器错误              |

- **其他说明：**
  - 该接口需要在请求头中携带token才能访问
  - 评论内容不能为空，长度限制为1-500个字符
  - 评论成功后会自动更新文章的评论数
  - 如果是回复评论，需要同时提供parentId和replyUserId
  - **⚠️ 当前状态：已实现**

### 3. 删除文章

**接口说明：** 删除当前用户发布的文章

- **请求URL：** `/api/article/{articleId}`
- **请求方式：** DELETE
- **请求参数：**

| 参数名    | 类型   | 必选 | 说明                    |
|-----------|--------|------|------------------------|
| articleId | number | 是   | 文章ID，包含在URL路径中 |

- **响应参数：**

| 参数名  | 类型   | 说明         |
|---------|--------|--------------|
| code    | number | 状态码       |
| message | string | 提示信息     |

- **响应示例：**

```json
{
    "code": 200,
    "message": "文章删除成功"
}
```

- **错误码说明：**

| 错误码 | 说明                       |
|--------|-----------------------------|
| 200    | 成功                        |
| 401    | 未登录或token无效           |
| 403    | 无权限删除此文章            |
| 404    | 文章不存在                  |
| 500    | 服务器错误                  |

- **其他说明：**
  - 该接口需要在请求头中携带token才能访问
  - 用户只能删除自己发布的文章
  - 删除文章会同时删除相关的点赞、收藏和评论数据
  - 删除文章不会删除已上传的图片文件
  - **✅ 当前状态：已实现**

## 可复用组件

### 文章列表组件 (ArticleList)

**组件说明：** 可复用的文章列表组件，支持多种列表类型、标签筛选、用户文章等功能

1. **组件路径：** `/components/article-list/article-list.vue`

2. **组件属性：**

| 属性名           | 类型            | 默认值       | 说明                                     |
|-----------------|-----------------|-------------|------------------------------------------|
| listType        | String          | 'recommend' | 列表类型: recommend(推荐)、follow(关注)、hot(热门)、new(最新)、tag(标签)、collection(收藏) |
| tagName         | String          | ''          | 标签名称，当listType为tag时使用           |
| userId          | Number/String   | null        | 用户ID，当获取指定用户的文章时使用        |
| showManageOptions | Boolean       | false       | 是否显示管理选项（编辑、删除）           |
| emptyText       | String          | '暂无内容'   | 空列表提示文本                           |
| autoLoad        | Boolean         | true        | 是否自动加载（组件挂载后是否自动请求数据）|
| height          | String          | 'calc(100vh - 165rpx)' | 列表高度                      |

3. **组件事件：**

| 事件名         | 参数                    | 说明                          |
|---------------|-------------------------|------------------------------|
| refresh       | 无                      | 列表刷新时触发                |
| loadMore      | 无                      | 加载更多内容时触发            |
| articleClick  | articleId (文章ID)      | 点击文章时触发                |
| authorClick   | authorId (作者ID)       | 点击作者头像或昵称时触发      |
| tagClick      | tag (标签名称)          | 点击文章标签时触发            |
| share         | article (文章对象)      | 点击分享按钮时触发            |
| comment       | article (文章对象)      | 点击评论按钮时触发            |
| collect       | article (文章对象)      | 点击收藏按钮时触发            |
| like          | article (文章对象)      | 点击点赞按钮时触发            |
| edit          | article (文章对象)      | 点击编辑按钮时触发            |
| delete        | article (文章对象)      | 点击删除按钮时触发            |
| follow        | author (作者对象)       | 点击关注/取消关注按钮时触发   |

4. **组件方法：**

| 方法名       | 参数     | 返回值  | 说明                        |
|-------------|----------|--------|----------------------------|
| loadArticles | 无       | 无     | 加载文章列表数据             |
| resetList   | 无       | 无     | 重置列表数据并回到第一页      |
| refresh     | 无       | 无     | 刷新列表数据                 |

5. **使用示例：**

```html
<template>
  <view class="container">
    <ArticleList
      ref="articleListRef"
      list-type="recommend"
      @article-click="handleArticleClick"
      @author-click="handleAuthorClick"
      @tag-click="handleTagClick"
    />
  </view>
</template>

<script setup>
  import { ref } from 'vue';
  import ArticleList from '@/components/article-list/article-list.vue';
  
  const articleListRef = ref(null);
  
  const handleArticleClick = (articleId) => {
    // 处理文章点击事件
    uni.navigateTo({ url: `/pages/article-detail/article-detail?id=${articleId}` });
  };
  
  const handleAuthorClick = (authorId) => {
    // 处理作者点击事件
    uni.navigateTo({ url: `/pages/user-profile/user-profile?id=${authorId}` });
  };
  
  const handleTagClick = (tag) => {
    // 处理标签点击事件
    console.log(`查看标签: ${tag}`);
  };
</script>
```

6. **数据结构：**

组件内部使用的文章数据结构：

```js
{
  id: 1,                               // 文章ID
  title: '文章标题',                     // 文章标题
  summary: '文章摘要...',                // 文章摘要
  content: '文章内容...',                // 文章内容
  coverImage: '/uploads/cover.jpg',     // 封面图片
  images: ['/uploads/img1.jpg', ...],   // 文章图片数组（多图模式）
  tags: ['标签1', '标签2'],              // 文章标签
  likeCount: 156,                       // 点赞数量
  commentCount: 38,                     // 评论数量
  collectCount: 45,                     // 收藏数量
  isLiked: false,                       // 当前用户是否已点赞
  isCollected: false,                   // 当前用户是否已收藏
  createTime: '2024-04-20 10:00:00',    // 创建时间
  updateTime: '2024-04-20 10:00:00',    // 更新时间
  author: {                             // 作者信息
    id: 10001,                          // 作者ID
    nickname: '用户昵称',                // 作者昵称
    avatar: '/uploads/avatar.jpg',      // 作者头像
    isFollowed: false                   // 当前用户是否已关注作者
  }
}
```

7. **功能说明：**

   - 支持多种列表类型：推荐、关注、热门、最新、标签筛选、收藏文章
   - 支持获取指定用户发布或点赞的文章列表
   - 自动处理分页加载和加载更多功能
   - 支持下拉刷新和到底加载更多
   - 自动处理文章封面图片和多图显示
   - 支持关注用户、点赞文章、收藏文章等交互功能
   - 支持显示文章管理功能（编辑、删除）
   - 根据登录状态自动处理用户关注显示
   - 优化了空列表状态和加载状态的显示
   - 支持自定义列表高度，适应不同的页面布局需求

8. **数据源与API适配：**

   - 根据`blog_uniapp_db.sql`中的表结构，组件内部会自动适配后端返回的数据
   - 包括文章表(`tb_article`)、标签表(`tb_tag`)、文章-标签关联表(`tb_article_tag`)、点赞表(`tb_article_like`)和收藏表(`tb_article_collect`)
   - 自动处理点赞和收藏状态，避免每次查询时需要额外请求
   - 根据不同的列表类型自动选择对应的API接口

9. **API接口调用：**

   组件根据不同属性选择对应的API接口：

   - **获取指定用户的文章列表** 
     - API路径：`/api/article/user/{userId}/articles`
     - 请求方式：GET
     - 参数说明：
       | 参数名 | 说明 |
       |--------|------|
       | userId | 用户ID，路径参数 |
       | type | 文章类型：posts(发表的)或likes(点赞的)，默认posts |
       | page | 页码，默认1 |
       | pageSize | 每页记录数，默认10 |
     - 当`listType`为'posts'时，`type=posts`；当`listType`为'like'时，`type=likes`

   - **收藏文章操作** 
     - API路径：`/api/article/collect/{articleId}`
     - 请求方式：POST(收藏)或DELETE(取消收藏)
     - 参数说明：
       | 参数名 | 说明 |
       |--------|------|
       | articleId | 文章ID，路径参数 |
     - 需要在请求头中添加`Authorization: Bearer {token}`

   - **点赞文章操作** 
     - API路径：`/api/article/like/{articleId}`
     - 请求方式：POST(点赞)或DELETE(取消点赞)
     - 参数说明：
       | 参数名 | 说明 |
       |--------|------|
       | articleId | 文章ID，路径参数 |
     - 需要在请求头中添加`Authorization: Bearer {token}`

10. **运行时优化：**

   - 使用响应式数据确保性能优化
   - 图片加载优化，使用`mode="aspectFill"`确保图片显示一致
   - 支持标签点击跳转到标签筛选页
   - 用户头像和昵称点击跳转到用户资料页
   - 自动处理文章摘要显示和"全文"显示
   - 优化了按钮点击体验和反馈提示

### 个人中心页面 (my.vue)

**页面说明：** 用户个人中心页面，展示用户个人信息、关注统计和文章列表等内容

1. **页面路径：** `/pages/my/my.vue`

2. **API调用：**

   - **获取当前登录用户信息**
     - API路径：`/api/user/info`
     - 请求方式：GET
     - 请求参数：无
     - 响应数据：
       ```json
       {
         "code": 200,
         "message": "操作成功",
         "data": {
           "id": 1,
           "email": "user@example.com",
           "nickname": "示例用户",
           "avatar": "https://example.com/avatars/default.jpg",
           "bio": "这是我的个人简介",
           "followCount": 10,
           "fansCount": 5,
           "articleCount": 8,
           "createTime": "2023-05-01 12:00:00"
         }
       }
       ```
     - 用于初始化用户个人资料、关注数量和粉丝数量等信息
     - 数据适配：后端返回的`fansCount`字段在前端使用`followerCount`

   - **更新用户个人资料**
     - API路径：`/api/user/profile`
     - 请求方式：PUT
     - 请求参数：
       ```json
       {
         "nickname": "新昵称", // 可选，仅更新个人简介时可不传
         "bio": "新的个人简介" // 可选，仅更新昵称时可不传
       }
       ```
     - 通过`handleNicknameChange`和`handleBioChange`方法调用

   - **上传用户头像**
     - API路径：`/api/user/avatar`
     - 请求方式：POST（multipart/form-data）
     - 请求参数：
       | 参数名 | 说明 |
       |--------|------|
       | avatar | 头像文件 |
     - 通过`handleAvatarChange`方法调用

   - **获取用户文章列表**
     - 通过ArticleList组件实现，根据选中的标签页(`data.currentTab`)显示用户发表的文章或用户点赞的文章：
       - 当`data.currentTab === 0`时，显示用户发表的文章(`list-type="posts"`)
       - 当`data.currentTab === 1`时，显示用户点赞的文章(`list-type="like"`)
     - 实际API调用由ArticleList组件处理，详见组件文档

3. **交互事件处理：**

   - **切换标签页**
     - 方法：`switchTab(index)`
     - 功能：切换"我的发表"和"我的点赞"标签页，并重新加载对应类型的文章列表
     - 相关API调用：通过ArticleList组件的`resetList`和`loadArticles`方法实现

   - **编辑个人简介**
     - 方法：`toggleBioEdit()`和`saveUserBio()`
     - 功能：显示/隐藏个人简介编辑弹窗，并保存修改后的个人简介
     - 相关API调用：使用`updateUserProfile({ bio: bioValue })`接口

   - **文章操作**
     - 通过ArticleList组件的事件实现文章的查看、点赞、收藏、评论、编辑和删除等操作
     - 点击编辑文章时，跳转到发布页面并传递文章数据进行编辑
     - 点击删除文章时，弹出确认对话框并在确认后调用删除文章API

4. **数据刷新机制：**

   - **页面显示时刷新**
     - 在`onShow`生命周期钩子中调用`refreshUserInfo()`方法刷新用户信息
     - 在`onShow`生命周期钩子中调用ArticleList组件的`refresh()`方法刷新文章列表
     
   - **节流控制**
     - 使用`refreshTimeoutId`实现300ms的节流控制，避免频繁刷新数据
     - 使用缓存的用户基本信息作为首屏渲染数据，提高页面加载速度

5. **状态管理：**

   - 使用Vue 3的Composition API (`reactive`和`ref`)管理页面状态
   - 页面核心状态包括：用户信息(`data.userInfo`)、当前标签页(`data.currentTab`)、设置面板显示状态(`data.showUserSettings`)等
   - 使用`watch`监听设置面板显示状态，实现物理返回键的拦截处理

6. **注意事项：**

   - 页面首次加载时，会优先使用本地缓存的用户信息进行渲染，然后再通过API获取完整的用户信息
   - 使用`getCurrentUser()`方法获取当前登录用户，用于判断文章是否为当前用户所发表
   - 页面实现了物理返回键和返回手势的拦截处理，提高用户体验
   - 用户头像和个人简介都有默认值，确保UI显示的完整性